import{m as y}from"./index.rsHMLtC6.js";const m=5,c=6,g=10;let N=(e,d,n,a)=>(e.events=e.events||{},e.events[n+g]||(e.events[n+g]=a(l=>{e.events[n].reduceRight((i,r)=>(r(i),i),{shared:{},...l})})),e.events[n]=e.events[n]||[],e.events[n].push(d),()=>{let l=e.events[n],i=l.indexOf(d);l.splice(i,1),l.length||(delete e.events[n],e.events[n+g](),delete e.events[n+g])}),T=1e3,k=(e,d)=>N(e,a=>{let l=d(a);l&&e.events[c].push(l)},m,a=>{let l=e.listen;e.listen=(...r)=>(!e.lc&&!e.active&&(e.active=!0,a()),l(...r));let i=e.off;return e.events[c]=[],e.off=()=>{i(),setTimeout(()=>{if(e.active&&!e.lc){e.active=!1;for(let r of e.events[c])r();e.events[c]=[]}},T)},()=>{e.listen=l,e.off=i}}),w=e=>e,u={},f={addEventListener(){},removeEventListener(){}};function M(){try{return typeof localStorage<"u"}catch{return!1}}M()&&(u=localStorage);let O={addEventListener(e,d,n){window.addEventListener("storage",d),window.addEventListener("pageshow",n)},removeEventListener(e,d,n){window.removeEventListener("storage",d),window.removeEventListener("pageshow",n)}};typeof window<"u"&&(f=O);function S(e,d={},n={}){let a=n.encode||w,l=n.decode||w,i=y(),r=i.setKey,E=(t,s)=>{typeof s>"u"?(n.listen!==!1&&f.perKey&&f.removeEventListener(e+t,v,o),delete u[e+t]):(n.listen!==!1&&f.perKey&&!(t in i.value)&&f.addEventListener(e+t,v,o),u[e+t]=a(s))};i.setKey=(t,s)=>{E(t,s),r(t,s)};let h=i.set;i.set=function(t){for(let s in t)E(s,t[s]);for(let s in i.value)s in t||E(s,void 0);h(t)};function v(t){t.key?t.key.startsWith(e)&&(t.newValue===null?r(t.key.slice(e.length),void 0):r(t.key.slice(e.length),l(t.newValue))):h({})}function o(){let t={...d};for(let s in u)s.startsWith(e)&&(t[s.slice(e.length)]=l(u[s]));for(let s in t)i.setKey(s,t[s])}return k(i,()=>{if(o(),n.listen!==!1)return f.addEventListener(e,v,o),()=>{f.removeEventListener(e,v,o);for(let t in i.value)f.removeEventListener(e+t,v,o)}}),i}const L=S("dtalles_favorites",{},{encode:JSON.stringify,decode:JSON.parse});function R(e){const d=L.get();if(d[e.id]){const n={...d};delete n[e.id],L.set(n)}else L.setKey(e.id,{...e,addedAt:Date.now()})}export{L as f,R as t};
